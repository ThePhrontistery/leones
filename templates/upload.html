{% extends "base.html" %}
{% block content %}
<div class="w-full max-w-md mx-auto mt-8">
  <h2 class="text-xl font-bold text-blue-700 mb-4">Subir documento</h2>
  <form id="upload-form" hx-post="/api/document/upload" hx-encoding="multipart/form-data" hx-target="#upload-result" hx-swap="innerHTML" class="flex flex-col gap-4 w-full">
    <input type="file" name="file" required class="block w-full text-sm text-slate-700 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100" />
    <input type="text" name="categoria" placeholder="Categoría" required class="rounded border px-3 py-2 text-slate-700" />
    <input type="text" name="descripcion" placeholder="Descripción breve" class="rounded border px-3 py-2 text-slate-700" />
    <button type="submit" class="bg-blue-700 text-white px-4 py-2 rounded hover:bg-blue-800 transition">Upload documento</button>
  </form>
  <div id="upload-result" class="mt-4"></div>
</div>
<script>
  document.addEventListener('htmx:afterSwap', function(evt) {
    if (evt.target && evt.target.id === 'upload-result') {
      if (window.opener) {
        window.opener.document.body.dispatchEvent(new Event('documentUploaded'));
        setTimeout(() => window.close(), 200);
      }
    }
  });
</script>
{% endblock %}
